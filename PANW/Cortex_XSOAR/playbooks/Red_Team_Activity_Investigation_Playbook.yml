id: Red_Team_Activity_Investigation_Playbook
version: -1
name: Red Team Activity Investigation with MITRE ATT&CK Alignment
description: Comprehensive playbook for investigating red team and adversary activities including lateral movement, credential harvesting, exfiltration, privilege escalation, and process injection. Integrates with Cortex XDR XQL queries and maps findings to MITRE ATT&CK framework.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: "0"
    type: start
    task:
      id: "0"
      name: Start Investigation
      description: Initiates red team activity investigation
      type: start
      iscommand: false
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "1"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: "1"
    type: regular
    task:
      id: "1"
      name: Initialize Investigation
      description: Set up investigation parameters and gather initial context
      type: regular
      script: ""
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "2"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "2":
    id: "2"
    taskid: "2"
    type: playbook
    task:
      id: "2"
      name: Detect Lateral Movement
      description: Execute XQL queries to detect lateral movement activities (T1021.001, T1021.002, T1078)
      type: playbook
      playbookName: Detect_Lateral_Movement
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "3"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "3":
    id: "3"
    taskid: "3"
    type: playbook
    task:
      id: "3"
      name: Detect Credential Harvesting
      description: Execute XQL queries to detect credential harvesting activities (T1003.001, T1003.002, T1555.003)
      type: playbook
      playbookName: Detect_Credential_Harvesting
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "4"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "4":
    id: "4"
    taskid: "4"
    type: playbook
    task:
      id: "4"
      name: Detect Data Exfiltration
      description: Execute XQL queries to detect data exfiltration activities (T1041, T1567.002, T1020, T1071.004)
      type: playbook
      playbookName: Detect_Data_Exfiltration
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "5"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "5":
    id: "5"
    taskid: "5"
    type: playbook
    task:
      id: "5"
      name: Detect Privilege Escalation
      description: Execute XQL queries to detect privilege escalation activities (T1548.002, T1543.003, T1053.005, T1134, T1112)
      type: playbook
      playbookName: Detect_Privilege_Escalation
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "6"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "6":
    id: "6"
    taskid: "6"
    type: playbook
    task:
      id: "6"
      name: Detect Process Injection
      description: Execute XQL queries to detect process injection activities (T1055)
      type: playbook
      playbookName: Detect_Process_Injection
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "7"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "7":
    id: "7"
    taskid: "7"
    type: playbook
    task:
      id: "7"
      name: Detect Persistence Mechanisms
      description: Execute XQL queries to detect persistence mechanisms (T1547.001, T1053.005)
      type: playbook
      playbookName: Detect_Persistence
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "8"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "8":
    id: "8"
    taskid: "8"
    type: playbook
    task:
      id: "8"
      name: Detect Defense Evasion
      description: Execute XQL queries to detect defense evasion activities (T1070.001, T1218.005)
      type: playbook
      playbookName: Detect_Defense_Evasion
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "9"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "9":
    id: "9"
    taskid: "9"
    type: regular
    task:
      id: "9"
      name: Build Attack Timeline
      description: Correlate all findings and build comprehensive attack timeline
      type: regular
      script: ""
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "10"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "10":
    id: "10"
    taskid: "10"
    type: regular
    task:
      id: "10"
      name: Map to MITRE ATT&CK
      description: Map all detected techniques to MITRE ATT&CK framework
      type: regular
      script: ""
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "11"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "11":
    id: "11"
    taskid: "11"
    type: regular
    task:
      id: "11"
      name: Generate Investigation Report
      description: Generate comprehensive investigation report with MITRE ATT&CK alignment
      type: regular
      script: ""
      brand: ""
      version: -1
    nexttasks:
      '#none#':
        - "12"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
  "12":
    id: "12"
    taskid: "12"
    type: title
    task:
      id: "12"
      name: Investigation Complete
      description: Investigation completed successfully
      type: title
      brand: ""
      version: -1
    nexttasks:
      '#none#': []
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping: []
inputs: []
outputs: []
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1350,
        "width": 1850,
        "x": 0,
        "y": 0
      }
    }
  }
fromversion: "6.0.0"
toversion: "6.10.0"
